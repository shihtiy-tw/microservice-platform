description = "Convert existing tasks into actionable Vibe Kanban tasks for the feature based on available design artifacts."

prompt = """
---
description: Convert existing tasks into actionable Vibe Kanban tasks for the feature based on available design artifacts.
tools: ['vibe_kanban_get_context', 'vibe_kanban_create_task']
---

## User Input

```text
$ARGUMENTS
```

You **MUST** consider the user input before proceeding (if not empty).

## Outline

1. Run `.specify/scripts/bash/check-prerequisites.sh --json --require-tasks --include-tasks` from repo root and parse FEATURE_DIR and AVAILABLE_DOCS list. All paths must be absolute. For single quotes in args like "I'm Groot", use escape syntax: e.g 'I'\\''m Groot' (or double-quote if possible: "I'm Groot").
1. From the executed script, extract the path to **TASKS**.
1. Read the `tasks.md` file from the extracted path.
1. Get the current project context by running:
   - `vibe_kanban_get_context` to get the `project_id`.
1. **Group Tasks by Phase/User Story**:
   - Parse `tasks.md` and identify sections starting with `## Phase N: [Title]`.
   - For each section, collect all atomic tasks (`- [ ] ...`) belonging to it.
1. **Create Vibe Kanban Tasks**:
   - For each **Phase/User Story** identified:
     - `project_id`: Use the ID obtained from `vibe_kanban_get_context`.
     - `title`: Enforce the naming convention: **"Spec {NNN}: {Priority}/{Story} {Description}"**
       - `{NNN}`: Extract the 3-digit Spec ID from the `FEATURE_DIR` or the `id` field in `spec.md`.
       - `{Priority}`: Extract the priority (e.g., P1, P2) from the `spec.md` or the Phase header.
       - `{Story}`: Extract the Story label (e.g., US1, US2) from the Phase header.
       - `{Description}`: Extract the user story title/description from the Phase header.
     - `description`: Create a markdown checklist of all atomic tasks (`- [ ] ...`) within that phase.
1. If there are tasks not belonging to any phase (e.g., at the top of the file), create a "Spec {NNN}: Setup/Foundation" task for them.

> [!IMPORTANT]
> This grouping ensures the Kanban board tracks meaningful increments (User Stories/Phases) rather than atomic file changes, keeping the board clean and actionable.
"""
